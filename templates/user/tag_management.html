{% extends 'layouts/basefile/base.html' %}
{% block content %}
{% load static %}



<!-- Start content -->
<div class="content">
    <div class="container-fluid">
        <div class="page-title-box">
            <div class="row align-items-center">
                <div class="col-sm-6">
                    <h4 class="page-title">List Management</h4>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="javascript:void(0);"><i
                                    class="mdi mdi-home-outline"></i></a></li>
                        <li class="breadcrumb-item active">Tags Management</li>
                    </ol>
                </div>
            </div> <!-- end row -->
        </div>
        <!-- end page-title -->

        <div class="row">

            <!--settings partial sidebar-->
            {% include 'partials/settings_sidebar.html' %}

            <div class="col-sm-9 col-md-9 col-lg-10">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                    <!-- Manage Lists tab link -->

                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'list_management' %}">
                            <i class="fas fa-th-list "></i>&nbsp;&nbsp;Manage Lists
                        </a>
                    </li>
                    <!-- Manage Tags tab link -->

                    <li class="nav-item tag">
                        <a class="nav-link active" href="{% url 'tags_management' %}">
                            <i class="fas fa-tags "></i> &nbsp;Manage Tags
                        </a>
                    </li>

                </ul>
                <!-- Tab panes start -->
                <div class="tab-content">
                    <!-- Manage Lists tab start-->
                    <div class="tab-pane active" id="manage-list" role="tabpanel">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div id="list__field_btn" class="col-sm-12">
                                        <a href="{% url 'create_tag' %}" class="btn btn-primary btn-sm waves-effect waves-light float-right mb-2 mr-2">
                                            <i class="mdi mdi-plus"></i> Add New Tag
                                        </a>

                                    </div>
                                </div> <!-- end row -->
                                <div id="list_table">
                                    <table id="datatable-buttons" class="table table-hover dt-responsive nowrap"
                                    style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>Name</th>
                                                <th>Description</th>
                                                <th>Status</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                           {% for tag in tags_list %}
                                                <tr>
                                                    <td>{{ tag.id }}</td>
                                                    <td><a href="{% url 'update_tag' tag.id %}" class="btn btn-block btn-sm btn-primary btn_wrap_content">{{ tag.name }}</a></td>

                                                    <td id="descr">{{ tag.tag_description }}</td>
                                                    <td><span {% if tag.tag_status == 'Active' %} class="badge badge-success font-12" {% else %} class="badge badge-primary font-12" {% endif %}>{{ tag.tag_status }}</span></td>
                                                    <td>
                                                        <div class=" " role="group"
                                                            aria-label="Basic example">
                                                            <a href="{% url 'update_tag' tag.id %}" type="button" class="btn btn-primary btn-sm" data-toggle="tooltip"
                                                            data-placement="top" title="" data-original-title="Edit"><i
                                                                class="mdi mdi-grease-pencil"></i></a>
                                                            <button type="button" list-id="{{ tag.id }}" class="btn btn-danger btn-sm list-delete" data-original-title="Delete" data-toggle="tooltip"><i
                                                                    class="mdi mdi-trash-can-outline"></i></button>
                                                        </div>
                                                    </td>
                                                </tr>
                                           {% endfor %}




                                        </tbody>
                                    </table>


                                    <div class="modal" id="viewModal">
                                        <div class="modal-dialog modal-dialog-scrollable">
                                          <div class="modal-content">

                                            <!-- Modal Header -->
                                            <div class="modal-header">
                                              <h2 class="modal-title" id="heading_id"></h2>
                                            </div>

                                            <!-- Modal body -->
                                            <div class="modal-body">

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Name</label>
                                                        <div>
                                                            <input readonly class="form-control" id="title" name="title" >
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                    <label>Created By</label>
                                                    <div>
                                                        <input readonly class="form-control" type="text" id="created_by" name="created_by" >
                                                    </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Status</label>
                                                        <div>
                                                            <input readonly class="form-control" type="text" id="plan" name="plan">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Data Import?</label>
                                                        <div>
                                                            <input readonly class="form-control" id="hash_off" name="hash_off" type="text">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Update Option</label>
                                                        <div>
                                                            <input id="temperature" name="temperature" readonly class="form-control" type="text">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>List Pull Everyday</label>
                                                        <textarea readonly id="distribution_status" class="form-control" name="distribution_status"></textarea>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>List Pulled?</label>
                                                        <div>
                                                            <input id="approval" name="approval" readonly class="form-control" type="text">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Created At</label>
                                                        <div>
                                                            <input id="scheduled_plan_for" name="scheduled_plan_for" readonly class="form-control" type="text">
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

                                            <!-- Modal footer -->
                                            <div class="modal-footer">
                                              <button type="button" class="btn btn-outline-dark waves-effect waves-light" data-dismiss="modal">Close</button>
                                            </div>

                                          </div>
                                        </div>
                                      </div>

                                        <div class="modal fade" id="deleteListModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                Confirm!
                                            </div>
                                            <div class="modal-body">
                                                Do you really want to delete this List?
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-outline-dark waves-effect waves-light"
                                                    data-dismiss="modal">No</button>
                                                <a id="delete-tag" class="btn btn-outline-danger waves-effect waves-light btn-ok">Yes</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </div>

                            </div>

                        </div>
                    </div>
                    <!-- Manage Tags tab starts-->
                    <div class="tab-pane" id="manage-tags" role="tabpanel">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-sm-12">
                                        <button
                                            class="btn btn-primary btn-sm waves-effect waves-light float-right mb-2 "
                                            type="button">
                                            <i class="mdi mdi-plus"></i> Add New Tag
                                        </button>
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered dt-responsive nowrap">
                                                <thead>
                                                    <tr>
                                                        <th>Name</th>
                                                        <th>Description </th>
                                                        <th>Status</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>My New Tag </td>
                                                        <td>This is dummy description</td>
                                                        <td>
                                                            Active
                                                        </td>
                                                        <td>
                                                            <div class="btn-group btn-group-sm" role="group"
                                                                aria-label="Basic example">
                                                                <button type="button" class="btn btn-primary mr-1"
                                                                    data-toggle="tooltip" data-placement="top" title=""
                                                                    data-original-title="Edit"><i
                                                                        class="mdi mdi-grease-pencil "></i></button>
                                                                <button type="button" class="btn btn-danger mr-1"><i
                                                                        class="mdi mdi-trash-can-outline"></i></button>
                                                            </div>
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div> <!-- end row -->
                                <!-- Add Tags Div Start -->
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label>Name</label>
                                            <div>
                                                <input type="text" class="form-control" required=""
                                                    placeholder="Enter Tag Name" autocomplete="on">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label>Description</label>
                                            <textarea required="" class="form-control" name="description"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label class="control-label">Status</label>
                                            <select class="form-control custom-select">
                                                <option selected disabled>Select Status</option>
                                                <option value="ac">Active</option>
                                                <option value="ia">Inactive</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-12">
                                        <button id="save_btn" class="btn btn-primary waves-effect waves-light" type="button">
                                            Save
                                        </button>
                                    </div>
                                </div> <!-- end row -->
                                <!-- Add Tags Div End -->
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- end col -->
        </div>
        <!-- container-fluid -->

    </div>
    </div>
    <!-- content -->

{% block extrajs %}

<script type="text/javascript">
$(window).on('load', function() {
    let loc = window.location.href;
    if (loc.indexOf("tags_management") >= 0) {
        $('#tag_href').addClass('active');
    }

});


$(document).ready(function() {
    $("#add_list").hide();

    $(document).on('click', '.list-delete', function(){
        selected_list = $(this).attr('list-id');
        url = window.location.origin + '/del_tag/' + selected_list;
        $('#delete-tag').attr("href", url);

        $('#deleteListModal').modal('show');
    });

});

function update_list_sequence () {
    var data = {
      pull_every_day : $("#pull_every_day").val(),
      pulled : $('input[name ="pulled"]:checked').val(),
      date : $("#date").val(),
      sequence_id : $("#sequence_id").val(),
      list_id : $("#hid_list_id").val(),
    };

    $.ajax({
         type: "POST",
         url: window.location.origin+"/update_or_create_sequence",
         data: JSON.stringify(data),
         contentType: "application/json; charset=utf-8",
         dataType: "json",
         success: function (result) {
         if(result.status==200)
         {
            $('#exampleModalScrollable').modal('hide');
            location.reload();
         }
         else
         {
            alert("There is some error");
            $('#exampleModalScrollable').modal('hide');

         }
       }
    });
}

function show_details(id) {
    console.log("id is: ",id)
    var data = {
      id : id,
    };

    $.ajax({
         type: "POST",
         url: window.location.origin+"/view_list",
         data: JSON.stringify(data),
         contentType: "application/json; charset=utf-8",
         dataType: "json",
         success: function (result) {
         if(result.status==200)
         {
            $("#heading_id").text(result.list_data.name)
            $("#title").val(result.list_data.name)
            $("#created_by").val(result.list_data.created_by)
            $("#plan").val(result.list_data.list_status)
            $("#hash_off").val(result.list_data.import_data)
            $("#temperature").val(result.list_data.update_option)
            $("#distribution_status").val(result.list_data.list_pull_everyday)
            $("#approval").val(result.list_data.pulled_status)
            $("#scheduled_plan_for").val(result.list_data.pull_date)
            $('#viewModal').modal('show');
         }
         else
         {
            alert("There is some error")
            $('#viewModal').modal('show');

         }
       }
    });
}


</script>
{% endblock %}


{% endblock %}