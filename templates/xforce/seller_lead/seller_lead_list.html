{% extends 'layouts/basefile/base.html' %}
{% block content %}
    {% load static %}
    <!-- Start content -->
    <div class="content">
        <div class="container-fluid">
            <div class="page-title-box">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <h4 class="page-title">Seller Leads</h4>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/home"><i
                                    class="mdi mdi-home-outline"></i></a></li>
                            <li class="breadcrumb-item "><a href="/x_force/">Xforce</a> </li>
                            <li class="breadcrumb-item">Seller Leads</li>
                            <input id="webform_lead_hidden_link" type="text" style="opacity: 0;">
                        </ol>
                    </div>
                    <div class="col-sm-6">
                        <a class="btn btn-primary waves-effect waves-light float-right" href="{% url 'new_seller_lead' %}">
                            <i class="mdi mdi-plus mr-2"></i> Add Seller Lead
                        </a>
                    </div>
                </div> <!-- end row -->
            </div>
            <!-- end page-title -->
            <div class="row">
                <div class="col-md-3 col-lg-2">
                    <div class="card mb-1">
                        <div class="card-body  p-0">
                            <div class="table-responsive border">
                                <table class="table table-striped mb-0 custom_sidbar">
                                    <tbody>

                                    <tr class="mb-0 bg-primary">
                                        <td class="custom_sidbar_title" style="padding-top: 8px;"><a href="" style="color:white;">All    <strong></strong></a></td>
                                    </tr>
                                    <!-- Next TITLE TAB -->
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title" style="padding-top: 2px;padding-bottom: 8px;"><a href="" style="border-top: none;" >New Untouched</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title"><a href="" style="" >Accepted Offer</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title" style="padding-top: 2px;padding-bottom: 8px;"><a href="" style="" >Offer Made Pending</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title"><a href="" style="" >Make Offer</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title" style="padding-top: 2px;padding-bottom: 8px;"><a href="" style="" >Lead Status</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title"><a href="" style="" >Your Leads</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title" style="padding-top: 2px;padding-bottom: 8px;"><a href="" style="" >Major markets</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title"><a href="" style="" >Deals</a></td>
                                    </tr>
                                    <tr class="mb-0">
                                        <td class="custom_sidbar_title"><a href="" style="" >Actions</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                    </div>

                    <div class="card mt-2">
                        <div class="card-body  p-2 ">

                            <label><strong class="font-weight-bold">Shareable link</strong></label>
                            <button id="webform_lead_btn"  class="btn btn-block btn-sm btn-primary "><i class="fa fa-link"></i> Copy Webform link</button>
                        </div>
                    </div>
                    
                </div>
                <div class="col-md-9 col-lg-10">
                    <!-- Nav tabs -->
                    <div class="card">
                        <div class="card-body">
                            {% if messages %}
                            {% for message in messages %}
                            <script>
                              var trans_message = "{{ message  | default_if_none:'' }}" ;
                            </script>
                            {% endfor %}
                            {% endif %}

                            <div class="table-responsive">
                                <table id="datatable-buttons" class="table table-hover dt-responsive nowrap"
                                       style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                    <thead class=" xsite_thead_background">
                                    <tr>
                                        <th>#</th>
                                        <th>Seller Name</th>
                                        <th>Seller Phone</th>
                                        <th>Property Address</th>
                                        <th>Date</th>
                                        <th>Lead Status</th>
                                        <th>Lead Source</th>
                                        <th>Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for seller in object_list %}
                                        <tr>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{forloop.counter}}</a></td>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.seller_name }}</a></td>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.seller_phone }}</a></td>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.property_address_map }}</a></td>
<!--                                            <script>-->
<!--                                                var created_date = "{{ seller.date }}";-->
<!--                                                // alert(typeof created_date)-->
<!--                                                alert(moment(created_date).local().format('MM/DD/YYYY h:mm A'))-->
<!--                                                // var start_format_date = moment(created_date).format('MM/DD/YYYY h:mm A');-->
<!--                                                // alert(start_format_date)-->
<!--                                            </script>-->
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.date }}</a></td>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.lead_status }}</a></td>
                                            <td><a  href="{% url 'edit_seller_lead' seller.id %}">{{ seller.lead_source }}</a></td>
                                            <td>

<!--                                                <a  href="{% url 'view_lead' seller.id %}"  type="button" class="btn btn-primary btn-sm btn-info" data-toggle="tooltip"-->
<!--                                                    data-placement="top" title="" data-original-title="view Sales Offer">-->
<!--                                                    <i class="mdi mdi-eye"></i>-->
<!--                                                </a>-->
                                                <a  href="{% url 'edit_seller_lead' seller.id %}" type="button" class="btn btn-primary btn-sm" data-toggle="tooltip"
                                                    data-placement="top" title="" data-original-title="Edit Sales Offer">
                                                    <i class="mdi mdi-grease-pencil"></i></a>
<!--                                                <a  href="{% url 'delete' seller.id %}" class="btn btn-danger btn-sm " ><i class="mdi mdi-trash-can-outline"></i></a>-->
                                                <a href="#" class="btn btn-danger btn-sm delete_lead_btn" lead-id = {{seller.id}}><i class="mdi mdi-trash-can-outline"></i></a>

                                            </td>


                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div> <!-- end col -->
            </div> <!-- end row -->
        </div>
        <!-- container-fluid -->
    </div>

<div class="modal hide fade" id="lead_delete_model" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true" style="z-index: 10000;">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Confirm
                    Delete</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this lead permanently?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal">Close
                </button>
<!--                     <a id="btnmodaldeletelead" class="btn btn-danger waves-effect waves-light btn-ok">Yes</a>-->
                <a id="btnmodaldeletelead" type="button" class="btn btn-danger">
                    Delete
                </a>
            </div>
        </div>
    </div>
</div>

<Script>
     $(document).ready(function () {
         var user_uid = "{{user_uuid|safe}}";
         var web_form_link = window.location.host + "/seller/seller_lead/" + user_uid + "/webform"
         // $("#webform_link").tooltip({title: web_form_link, placement: "top"})
         $("#webform_lead_btn").tooltip();
         $("#webform_lead_btn").attr("title", web_form_link);
         $('#webform_lead_hidden_link').val(web_form_link);
         $("#webform_lead_btn").click(function () {
             var copyText = document.getElementById("webform_lead_hidden_link");
             copyText.select();
             copyText.setSelectionRange(0, 99999);
             document.execCommand("copy");
             toastr.success("Link Copied Successfully");
         });
         // if (trans_message) {
         //     toastr.warning(trans_message);
         // }


     });
     $(document).on("click", ".delete_lead_btn", function () {
         var lead_id = $(this).attr('lead-id');
         var url = window.location.origin + '/seller/delete/' + lead_id;
         $('#btnmodaldeletelead').attr("href", url);
         $('#lead_delete_model').modal('show');
     });


</Script>


{% endblock %}